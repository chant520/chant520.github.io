{"posts":[{"title":"æ­å»ºä¸€ä¸ªvue-cli4+webpack+vantç§»åŠ¨ç«¯æ¡†æ¶","content":" æŠ€æœ¯æ ˆï¼švue-cli4 + webpack4 + vant + axios + less + postcss-px2rem è¦åŒ…æ‹¬å¦‚ä¸‹æŠ€æœ¯ç‚¹ï¼š vue-cli4è„šæ‰‹æ¶ vantæŒ‰éœ€å¼•å…¥ ç§»åŠ¨ç«¯remé€‚é… axiosæ‹¦æˆªå°è£… utilå·¥å…·ç±»å‡½æ•°å°è£… vue-routeré…ç½® ç™»å½•æƒé™æ ¡éªŒ å¤šç¯å¢ƒå˜é‡é…ç½® vue.config.jsé…ç½® toastç»„ä»¶å°è£… dialogç»„ä»¶å°è£… è·¨åŸŸä»£ç†è®¾ç½® webpackæ‰“åŒ…å¯è§†åŒ–åˆ†æ CDNèµ„æºä¼˜åŒ– gzipæ‰“åŒ…ä¼˜åŒ– é¦–é¡µæ·»åŠ éª¨æ¶å± vueåˆå§‹åŒ–é¡¹ç›® vue create [project name] å®‰è£…vant # é€šè¿‡ npm å®‰è£… npm i vant -S # é€šè¿‡ yarn å®‰è£… yarn add vant å®‰è£…babel-plugin-import npm i babel-plugin-import -D è®°å¾—åŠ -Då› ä¸ºæˆ‘ä»¬åªç»™å¼€å‘è€…ä½¿ç”¨ é…ç½®babel-plugin-import // åœ¨.babelrc ä¸­æ·»åŠ é…ç½® { &quot;plugins&quot;: [ [&quot;import&quot;, { &quot;libraryName&quot;: &quot;vant&quot;, &quot;libraryDirectory&quot;: &quot;es&quot;, &quot;style&quot;: true }] ] } // å¯¹äºä½¿ç”¨ babel7 çš„ç”¨æˆ·ï¼Œå¯ä»¥åœ¨ babel.config.js ä¸­é…ç½® module.exports = { plugins: [ ['import', { libraryName: 'vant', libraryDirectory: 'es', style: true }, 'vant'] ] }; æŒ‰éœ€å¼•å…¥ï¼šä»£ç ä¸­ç›´æ¥å¼•å…¥ Vant ç»„ä»¶ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨å°†ä»£ç è½¬åŒ–ä¸ºæ–¹å¼äºŒä¸­çš„æŒ‰éœ€å¼•å…¥å½¢å¼ import Vue from 'vue' import { Button } from 'vant' Vue.use(Button) rem é€‚é… å®‰è£…px2rem-loaderæ’ä»¶ npm install px2rem-loader --save-dev åœ¨ vue.config.js è¿›è¡Œå¦‚ä¸‹é…ç½® css: { // cssé¢„è®¾å™¨é…ç½®é¡¹ loaderOptions: { postcss: { plugins: [ require('postcss-px2rem')({ remUnit: 100 }) ] } } } åœ¨ main.js è®¾ç½® html è·Ÿå­—ä½“å¤§å° function initRem() { let cale = window.screen.availWidth &gt; 750 ? 2 : window.screen.availWidth / 375 window.document.documentElement.style.fontSize = `${100 * cale}px` } window.addEventListener('resize', function() { initRem() }) ä½¿ç”¨axioså°è£…è¯·æ±‚ å®‰è£… npm install axios è®¾ç½®è¯·æ±‚æ‹¦æˆªå’Œå“åº”æ‹¦æˆª // æ–‡ä»¶ ./src/utils/axios.js import axios from 'axios' import vm from 'vm' const PRODUCT_URL = 'https://xxxx.com' const MOCK_URL = 'http://xxxx.com' let http = axios.create({ baseURL: process.env.NODE_ENV === 'production' ? PRODUCT_URL : MOCK_URL, }) // è¯·æ±‚æ‹¦æˆªå™¨ http.interceptors.request.use( (config) =&gt; { // è®¾ç½®tokenï¼ŒContent-Type var token = sessionStorage.getItem('token') config.headers['token'] = token config.headers['Content-Type'] = 'application/json;charset=UTF-8' // è¯·æ±‚æ˜¾ç¤ºloadingæ•ˆæœ if (config.loading === true) { vm.$loading.show() } return config }, (error) =&gt; { vm.$loading.hide() return Promise.reject(error) } ) // å“åº”æ‹¦æˆªå™¨ http.interceptors.response.use( (res) =&gt; { vm.$loading.hide() // tokenå¤±æ•ˆï¼Œé‡æ–°ç™»å½• if (res.data.code === 401) { // é‡æ–°ç™»å½• } return res }, (error) =&gt; { vm.$loading.hide() return Promise.reject(error) } ) å°è£… get å’Œ post è¯·æ±‚æ–¹æ³• // æ–‡ä»¶ ./src/utils/axios.js ... function get(url, data, lodaing) { return new Promise((resolve, reject) =&gt; { http .get(url) .then( (response) =&gt; { resolve(response) }, (err) =&gt; { reject(err) } ) .catch((error) =&gt; { reject(error) }) }) } function post(url, data, loading) { return new Promise((resolve, reject) =&gt; { http .post(url, data, { loading: loading }) .then( (response) =&gt; { resolve(response) }, (err) =&gt; { reject(err) } ) .catch((error) =&gt; { reject(error) }) }) } export { get, post } æŠŠ getï¼Œpost æ–¹æ³•æŒ‚è½½åˆ° vue å®ä¾‹ä¸Š // main.js import { get, post } from './utils/axios' Vue.prototype.$http = { get, post } å·¥å…·ç±»å‡½æ•°å°è£… ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ å°è£…æ–¹æ³• // æ–‡ä»¶ utils/common.js export default { install (Vue, options) { Vue.prototype.util = { method1(val) { ... }, method2 (val) { ... }, } } åœ¨ main.js é€šè¿‡ vue.use()æ³¨å†Œ import utils from './utils/common' Vue.use(utils) vue-router é…ç½® vue-router ä¸‰ç§é…ç½®æ–¹å¼ // 1ã€Vueå¼‚æ­¥ç»„ä»¶æŠ€æœ¯ï¼š { path: '/home', name: 'Home', component: resolve =&gt; reqire(['../views/Home.vue'], resolve) } // 2ã€es6ææ¡ˆçš„import() { path: '/', name: 'home', component: () =&gt; import('../views/Home.vue') } // 3ã€webpackæä¾›çš„require.ensure() { path: '/home', name: 'Home', component: r =&gt; require.ensure([],() =&gt; r(require('../views/Home.vue')), 'home') } æœ¬é¡¹ç›®é‡‡ç”¨çš„æ˜¯ç¬¬äºŒç§æ–¹å¼ï¼Œä¸ºäº†åç»­ webpack æ‰“åŒ…ä¼˜åŒ–ã€‚ æ”¹å˜å•é¡µé¢åº”ç”¨çš„ title router.beforeEach((to, from, next) =&gt; { document.title = to.meta.title }) ç™»å½•æ ¡éªŒ é…ç½®è·¯ç”±çš„ meta å¯¹è±¡çš„ auth å±æ€§ const routes = [ { path: '/', name: 'home', component: () =&gt; import('../views/Home.vue'), meta: { title: 'é¦–é¡µ', keepAlive: false, auth: false }, }, { path: '/mine', name: 'mine', component: () =&gt; import('../views/mine.vue'), meta: { title: 'æˆ‘çš„', keepAlive: false, auth: true }, }, ] åœ¨è·¯ç”±é¦–é¡µè¿›è¡Œåˆ¤æ–­ã€‚ å½“to.meta.authä¸ºtrue(éœ€è¦ç™»å½•)ï¼Œä¸”ä¸å­˜åœ¨ç™»å½•ä¿¡æ¯ç¼“å­˜æ—¶ï¼Œéœ€è¦é‡å®šå‘å»ç™»å½•é¡µé¢ router.beforeEach((to, from, next) =&gt; { document.title = to.meta.title const userInfo = sessionStorage.getItem('userInfo') || null if (!userInfo &amp;&amp; to.meta.auth) { next('/login') } else { next() } }) é¡µé¢ç¼“å­˜é…ç½® é€šè¿‡é…ç½®è·¯ç”±çš„ meta å¯¹è±¡çš„ keepAlive å±æ€§å€¼æ¥åŒºåˆ†é¡µé¢æ˜¯å¦éœ€è¦ç¼“å­˜ const routes = [ { path: '/', name: 'home', component: () =&gt; import('../views/Home.vue'), meta: { title: 'é¦–é¡µ', keepAlive: false, auth: false }, }, { path: '/list', name: 'list', component: () =&gt; import('../views/list.vue'), meta: { title: 'åˆ—è¡¨é¡µ', keepAlive: true, auth: false }, }, ] åœ¨ app.vue åšç¼“å­˜åˆ¤æ–­ &lt;div id=&quot;app&quot;&gt; &lt;router-view v-if=&quot;!$route.meta.keepAlive&quot;&gt;&lt;/router-view&gt; &lt;keep-alive&gt; &lt;router-view v-if=&quot;$route.meta.keepAlive&quot;&gt;&lt;/router-view&gt; &lt;/keep-alive&gt; &lt;/div&gt; å¤šç¯å¢ƒå˜é‡é…ç½® 1ã€åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ–°å»º.env.* .env.development æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½® NODE_ENV='development' VUE_APP_ENV = 'development' å¤åˆ¶ä»£ç  .env.test æµ‹è¯•ç¯å¢ƒé…ç½® NODE_ENV='test' VUE_APP_ENV = 'test' .env.production æ­£å¼ç¯å¢ƒé…ç½® NODE_ENV='production' VUE_APP_ENV = 'production' ä¸ºäº†åœ¨ä¸åŒç¯å¢ƒé…ç½®æ›´å¤šçš„å˜é‡ï¼Œæˆ‘ä»¬åœ¨ src æ–‡ä»¶ä¸‹æ–°å»ºä¸€ä¸ª config/index // æ ¹æ®ç¯å¢ƒå¼•å…¥ä¸åŒé…ç½® process.env.NODE_ENV const config = require('./env.' + process.env.VUE_APP_ENV) module.exports = config åœ¨åŒçº§ç›®å½•ä¸‹æ–°å»º env.development.jsï¼Œenv.test.jsï¼Œenv.production.jsï¼Œåœ¨é‡Œé¢é…ç½®éœ€è¦çš„å˜é‡ã€‚ ä»¥ env.development.js ä¸ºä¾‹ module.exports = { baseUrl: 'http://localhost:8089', // é¡¹ç›®åœ°å€ baseApi: 'https://www.mock.com/api', // æœ¬åœ°apiè¯·æ±‚åœ°å€ } 2ã€é…ç½®æ‰“åŒ…å‘½ä»¤ package.json é‡Œçš„ scripts ä¸åŒç¯å¢ƒçš„æ‰“åŒ…å‘½ä»¤ é€šè¿‡ npm run serve å¯åŠ¨æœ¬åœ° é€šè¿‡ npm run test æ‰“åŒ…æµ‹è¯• é€šè¿‡ npm run build æ‰“åŒ…æ­£å¼ &quot;scripts&quot;: { &quot;dev&quot;: &quot;vue-cli-service serve&quot;, &quot;build&quot;: &quot;vue-cli-service build&quot;, &quot;test&quot;: &quot;vue-cli-service build --mode test&quot;, } vue.config.js é…ç½® é…ç½®æˆ‘ä»¬é¡¹ç›®çš„ä¸œè¥¿ä¸»è¦åŒ…æ‹¬ æ‰“åŒ…åæ–‡ä»¶è¾“å‡ºä½ç½® å…³é—­ç”Ÿäº§ç¯å¢ƒ souecemap é…ç½® rem è½¬åŒ– px é…ç½® alias åˆ«å å»é™¤ç”Ÿäº§ç¯å¢ƒ console è·¨åŸŸä»£ç†è®¾ç½® module.exports = { publicPath: './', // é»˜è®¤ä¸º'/' // å°†æ„å»ºå¥½çš„æ–‡ä»¶è¾“å‡ºåˆ°å“ªé‡Œï¼Œæœ¬å¸è¦æ±‚ outputDir: 'dist/static', // æ”¾ç½®ç”Ÿæˆçš„é™æ€èµ„æº(jsã€cssã€imgã€fonts)çš„ç›®å½•ã€‚ assetsDir: 'static', // æŒ‡å®šç”Ÿæˆçš„ index.html çš„è¾“å‡ºè·¯å¾„ indexPath: 'index.html', // æ˜¯å¦ä½¿ç”¨åŒ…å«è¿è¡Œæ—¶ç¼–è¯‘å™¨çš„ Vue æ„å»ºç‰ˆæœ¬ã€‚ runtimeCompiler: false, transpileDependencies: [], // å¦‚æœä½ ä¸éœ€è¦ç”Ÿäº§ç¯å¢ƒçš„ source map productionSourceMap: false, // é…ç½®css css: { // æ˜¯å¦ä½¿ç”¨cssåˆ†ç¦»æ’ä»¶ ExtractTextPlugin extract: true, sourceMap: true, // cssé¢„è®¾å™¨é…ç½®é¡¹ loaderOptions: { postcss: { plugins: [ require('postcss-px2rem')({ remUnit: 100, }), ], }, }, // å¯ç”¨ CSS modules for all css / pre-processor files. vantæŒ‰éœ€å¼•å…¥ä¸€å®šè¦å¼€å¯ requireModuleExtension: true, }, // æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…è®¸å¯¹å†…éƒ¨çš„ webpack é…ç½®è¿›è¡Œæ›´ç»†ç²’åº¦çš„ä¿®æ”¹ã€‚ chainWebpack: (config) =&gt; { // é…ç½®åˆ«å config.resolve.alias .set('@', resolve('src')) .set('assets', resolve('src/assets')) .set('components', resolve('src/components')) .set('views', resolve('src/views')) config.optimization.minimizer('terser').tap((args) =&gt; { // å»é™¤ç”Ÿäº§ç¯å¢ƒconsole args[0].terserOptions.compress.drop_console = true return args }) }, // æ˜¯å¦ä¸º Babel æˆ– TypeScript ä½¿ç”¨ thread-loaderã€‚è¯¥é€‰é¡¹åœ¨ç³»ç»Ÿçš„ CPU æœ‰å¤šäºä¸€ä¸ªå†…æ ¸æ—¶è‡ªåŠ¨å¯ç”¨ï¼Œä»…ä½œç”¨äºç”Ÿäº§æ„å»ºã€‚ parallel: require('os').cpus().length &gt; 1, devServer: { host: '0.0.0.0', port: 8899, // ç«¯å£å· https: false, // https:{type:Boolean} open: false, // é…ç½®è‡ªåŠ¨å¯åŠ¨æµè§ˆå™¨ open: 'Google Chrome'-é»˜è®¤å¯åŠ¨è°·æ­Œ // é…ç½®å¤šä¸ªä»£ç† proxy: { '/api': { target: 'https://www.mock.com', ws: true, // ä»£ç†çš„WebSockets changeOrigin: true, // å…è®¸websocketsè·¨åŸŸ pathRewrite: { '^/api': '', }, }, }, }, } webpack å¯è§†åŒ–åˆ†æ å®‰è£… webpack-bundle-analyzer npm install webpack-bundle-analyzer -D æ’ä»¶é…ç½® åœ¨ vue.config.js é…ç½® const { BundleAnalyzerPlugin } = require('webpack-bundle-analyzer') configureWebpack: (config) =&gt; { if (process.env.NODE_ENV === 'production') { config.plugins.push(new BundleAnalyzerPlugin()) } } gzipå‹ç¼© å®‰è£…æ’ä»¶ npm install compression-webpack-plugin -D é…ç½®æ’ä»¶ configureWebpack: (config) =&gt; { if (process.env.NODE_ENV === 'production') { config.plugins.push(new BundleAnalyzerPlugin()) config.plugins.push(new CompressionPlugin({ // gzipå‹ç¼©é…ç½® test: /\\.js$|\\.html$|\\.css/, // åŒ¹é…æ–‡ä»¶å threshold: 10240, // å¯¹è¶…è¿‡10kbçš„æ•°æ®è¿›è¡Œå‹ç¼© deleteOriginalAssets: false // æ˜¯å¦åˆ é™¤åŸæ–‡ä»¶ })) } } æ·»åŠ éª¨æ¶å± å®‰è£…æ’ä»¶ npm install vue-skeleton-webpack-plugin é…ç½®æ’ä»¶ configureWebpack: (config) =&gt; { config.plugins.push(new SkeletonWebpackPlugin({ webpackConfig: { entry: { app: resolve('./src/common/entry-skeleton.js') } }, minimize: true, quiet: true, router: { mode: 'hash', routes: [ { path: '/', skeletonId: 'skeleton1' }, { path: '/about', skeletonId: 'skeleton2' } ] } })) } ","link":"https://chant520.github.io/da-jian-yi-ge-vue-cli4webpackvant-yi-dong-duan-kuang-jia/"},{"title":"Hello Gridea","content":"ğŸ‘ æ¬¢è¿ä½¿ç”¨ Gridea ï¼ âœï¸ Gridea ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ... Github Gridea ä¸»é¡µ ç¤ºä¾‹ç½‘ç«™ ç‰¹æ€§ğŸ‘‡ ğŸ“ ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ Markdown è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ ğŸŒ‰ ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡ ğŸ·ï¸ ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„ ğŸ“‹ ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå• ğŸ’» ä½ å¯ä»¥åœ¨ Windowsï¼ŒMacOS æˆ– Linux è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯ ğŸŒ ä½ å¯ä»¥ä½¿ç”¨ ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ æˆ– Coding Pages å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å° ğŸ’¬ ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ Gitalk æˆ– DisqusJS è¯„è®ºç³»ç»Ÿ ğŸ‡¬ğŸ‡§ ä½ å¯ä»¥ä½¿ç”¨ä¸­æ–‡ç®€ä½“æˆ–è‹±è¯­ ğŸŒ ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ› ğŸ–¥ ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥ ğŸŒ± å½“ç„¶ Gridea è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´ å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼ ğŸ˜˜ Enjoy~ ","link":"https://chant520.github.io/hello-gridea/"}]}